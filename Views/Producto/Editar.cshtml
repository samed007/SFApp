@model SFApp.DTOs.ProductosDTO
@{
    ViewData["Title"] = "Editar Producto";
}

<div class="container-caja mt-4">
    <h2 class="mb-4">Editar Producto</h2>

    <form asp-action="Editar" method="post" asp-controller="Producto">
        <!-- Hidden IdProducto -->
        <input type="hidden" asp-for="IdProducto" name="producto.IdProducto" />

        <div class="mb-3">
            <label asp-for="Producto" class="form-label"></label>
            <input asp-for="Producto" class="form-control" name="producto.Producto" required />
        </div>

        <div class="mb-3">
            <label asp-for="Marca" class="form-label"></label>
            <input asp-for="Marca" class="form-control" name="producto.Marca" required />
        </div>

        <div class="mb-3">
            <label asp-for="Descripcion" class="form-label"></label>
            <textarea asp-for="Descripcion" class="form-control" name="producto.Descripcion"></textarea>
        </div>

        <div class="mb-3">
            <label asp-for="EAN" class="form-label"></label>
            <input asp-for="EAN" class="form-control" name="producto.EAN" />
        </div>

        <div class="mb-3">
            <label asp-for="SKU" class="form-label"></label>
            <input asp-for="SKU" class="form-control" name="producto.SKU" />
        </div>

        <div class="mb-3">
            <label asp-for="PrecioCompra" class="form-label"></label>
            <input asp-for="PrecioCompra" class="form-control" type="number" step="0.01" lang="en" name="producto.PrecioCompra" />
        </div>

        <div class="mb-3">
            <label asp-for="IVA" class="form-label"></label>
            <input asp-for="IVA" class="form-control" type="number" step="0.01" lang="en" name="producto.IVA" />
        </div>

        <div class="mb-3">
            <label asp-for="PrecioTotal" class="form-label"></label>
            <input asp-for="PrecioTotal" class="form-control" type="number" step="0.01" lang="en" name="producto.PrecioTotal" required />
        </div>

        <div class="mb-3">
            <label asp-for="Categoria" class="form-label"></label>
            <input asp-for="Categoria" class="form-control" name="producto.Categoria" />
        </div>

        <div class="mb-3">
            <label asp-for="Talla" class="form-label"></label>
            <input asp-for="Talla" class="form-control" name="producto.Talla" />
        </div>

        <div class="mb-3">
            <label asp-for="Color" class="form-label"></label>
            <input asp-for="Color" class="form-control" name="producto.Color" />
        </div>
        
     <div class="mb-3">
        <label asp-for="Estado" class="form-label"></label>
        <select asp-for="Estado" class="form-select" asp-items="ViewBag.Estados" required name="producto.Estado">
            <option value="">-- Selecciona un estado --</option>
            <option value="A">Activo</option>
            <option value="I">Inactivo</option>
        </select>
    </div>


        <button type="submit" class="btn">Guardar cambios</button>
        <a asp-action="Index" class="btn">Cancelar</a>
    </form>
</div>
<!-- Modal de feedback -->
<div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header" id="feedbackModalHeader">
        <h5 class="modal-title" id="feedbackModalLabel">Mensaje</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <p id="feedbackMessage"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
    const successMessage = '@TempData["SuccessMessage"]';
    const errorMessage = '@TempData["ErrorMessage"]';

    let message = "";
    let isError = false;

    if (successMessage) {
        message = successMessage;
    } else if (errorMessage) {
        message = errorMessage;
        isError = true;
    }

    if (message) {
        document.getElementById("feedbackMessage").textContent = message;

        // Cambiar color del modal según tipo de mensaje
        const header = document.getElementById("feedbackModalHeader");
        if (isError) {
            header.style.backgroundColor = "#f8d7da"; // rojo claro
            header.style.color = "#842029";
            document.getElementById("feedbackModalLabel").textContent = "Error";
        } else {
            header.style.backgroundColor = "#d1e7dd"; // verde claro
            header.style.color = "#0f5132";
            document.getElementById("feedbackModalLabel").textContent = "Éxito";
        }

        const feedbackModal = new bootstrap.Modal(document.getElementById('feedbackModal'));
        feedbackModal.show();
    }
});
</script>
